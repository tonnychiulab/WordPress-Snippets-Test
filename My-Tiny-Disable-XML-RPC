/**
 * 完全關閉 XML-RPC 功能
 *
 * * 為什麼這樣做：
 *   XML-RPC 過去常用於遠端發布文章 (如 Windows Live Writer) 或 Pingback 功能。
 *   但在現代 WordPress (使用 REST API) 中已較少使用。
 *   由於 XML-RPC 允許透過單一請求嘗試數百次密碼組合 (暴力破解)，
 *   且容易被利用進行 DDoS 攻擊，因此若無特殊需求，建議完全關閉。
 *
 * * 安全性說明：
 *   此設定會攔截所有 XML-RPC 請求，並回傳錯誤訊息，有效防止針對 xmlrpc.php 的攻擊。
 */
add_filter( 'xmlrpc_enabled', '__return_false' );

/**
 * 移除 HTTP Header 中的 X-Pingback
 *
 * * 為什麼這樣做：
 *   即使關閉了 XML-RPC，WordPress 預設仍可能在 HTTP Header 回傳 `X-Pingback: https://.../xmlrpc.php`。
 *   這會暴露網站有 XML-RPC 進入點的資訊。為了資安隱匿性 (Security by Obscurity)，建議一併移除。
 *
 * @param array $headers 目前的 HTTP Headers 陣列
 * @return array 移除 X-Pingback 後的 Headers
 */
function my_remove_x_pingback_header( $headers ) {
	if ( isset( $headers['X-Pingback'] ) ) {
		unset( $headers['X-Pingback'] );
	}
	return $headers;
}
add_filter( 'wp_headers', 'my_remove_x_pingback_header' );

/**
 * 停用 XML-RPC 的 Pingback 方法 (額外防護)
 *
 * * 為什麼這樣做：
 *   這是多一層的防護，直接從 XML-RPC 的方法列表中移除 Pingback 相關功能。
 *   確保即使 XML-RPC 被意外啟用，Pingback 也無法運作。
 *
 * @param array $methods 現有的 XML-RPC 方法列表
 * @return array 移除 Pingback 後的方法列表
 */
function my_disable_xmlrpc_pingback_methods( $methods ) {
	unset( $methods['pingback.ping'] );
	unset( $methods['pingback.extensions.getPingbacks'] );
	return $methods;
}
add_filter( 'xmlrpc_methods', 'my_disable_xmlrpc_pingback_methods' );